<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Test</title>
    <link href='https://fonts.googleapis.com/css?family=PT+Sans|PT+Sans+Narrow:400,700|Inconsolata' rel='stylesheet' type='text/css'>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link href="css/style.css" rel="stylesheet">
    <link href="css/fjord.css" rel="stylesheet">
  </head>
  <body>
    <div id="compare" class="contain">
      <h2>Compare</h2>
      <h3>Mouse over any element to see how the elements compare.</h3>
      <div id="timeline"></div>
      <div style="display:flex;">
        <div class="accessories left-acc">
          <ol id="csv" class="eList"></ol>
        </div>
        <div id="main"></div>
        <div class="accessories right-acc">
          <div class="dropdown">
            <div class="dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
              <h4 class="drop">
                <span class="currentDataSet">1. Peabody 1501-1600</span>
                <span class="caret"></span>
              </h4>
            </div>
            <ul class="dropdown-menu data-picker" aria-labelledby="dropdownMenu1">
              <li><a data-index="1" data-parent="#compare">1. Peabody 1501-1600</a></li>
              <li><a data-index="2" data-parent="#compare">2. Another Data Set</a></li>
              <li><a data-index="3" data-parent="#compare">3. Another Data Set Again</a></li>
            </ul>
          </div>
          <ol id="evtList" class="eList"></ol>
        </div>
      </div>
    </div>
  </body>
  <script src="server.js"></script>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="js/bootstrap.min.js"></script>

  <!--<script src="js/fjord.js"></script>-->
  <script src="js/jquery-1.11.3.min.js"></script>
  <script src="js/d3.min.js"></script>
  <script src="js/two.min.js"></script>
  <script src="js/newCode/helpers.js"></script>
  <script src="js/newCode/evtEvtSet.js"></script>
  <script src="js/newCode/compare.js"></script>
  <script src="js/newCode/grid.js"></script>
  <script src="js/newCode/gridAccessories.js"></script>
  <script src="js/fullheight.js"></script>

  <script>
    var peabody=new EventSet();
    var test= new EventSet();
    var el = document.getElementById("main"),
      two = new Two({width:335,height:335});
    two.appendTo(el);
    var g=new Grid(.6,0);
    var eList=new List();
    var cList=new List("csv",true);
    var timeline= new Timeline();
    // start handles all loading for events.
    function start(){
      console.log("Loading data 1/2");
      peabody.loadFromCSV("peabodyData.csv", testing);
    }
    function testing(){
      console.log("Loading data 2/2");
      test.loadFromCSV("testing.csv",main);
    }
    function main(){
      test.sortByYear();
      peabody.sortByYear();
      g.addEventSet(peabody);
      eList.addEventSet(peabody);
      cList.addEventSet(peabody);
      timeline.addEventSet(peabody);
      g.draw(two);
      eList.draw();
      cList.draw();
      timeline.draw();
      two.update();
    }
    start();
    $("body").on("mouseover","path, rect, li",function(e){
      console.log('highlighting');
      if (e.currentTarget.getAttribute('data-date')==undefined){
        if(e.currentTarget.parentNode.getAttribute('data-date')==undefined){
          return;
        }
        var el=e.currentTarget.parentNode;
      }else{
        var el=e.currentTarget;
      }
      highlight(el,[g,eList,cList,timeline]);
    });
    $("body").on("mouseout","path, rect, li",function(e){
      console.log(e.currentTarget);
      if (e.currentTarget.getAttribute('data-date')==undefined){
        if(e.currentTarget.parentNode.getAttribute('data-date')==undefined){
          return;
        }
        var el=e.currentTarget.parentNode;
      }else{
        var el=e.currentTarget;
      }
      unhighlight(el,[g,eList,cList,timeline]);
    });
    $("#main").on("click","path",function(e){
      g.clickHandle(e,two);
    });
    $("#compare .data-picker").on("click","a", function(e){
      changeSet(e,"#compare");
    });
    function changeSet(e, parent){
      console.log(e);
      if(e.currentTarget.dataset.index==1){
        reload([g,eList,timeline,cList],peabody,two);
      }else if (e.currentTarget.dataset.index==2) {
        reload([g,eList,timeline,cList],test,two);
      }else{
        return
      }
      $(parent+" .currentDataSet").html(e.currentTarget.innerHTML);
    }
  </script>

<!--
  TODO: Build an input taking version of grid
-->
</html>
